import{S as I,P as R,W as $,O as D,d as T,h as G,C as H,e as v,M as x,i as z,A as W,j as F,B as _,a as Q,c as V,b as O,k as U,V as J}from"./OrbitControls-wnF1M9xv.js";const s=document.getElementById("globe-view"),l=new I,u=new R(45,s.clientWidth/s.clientHeight,.1,1e3),m=new $({antialias:!0});m.setSize(s.clientWidth,s.clientHeight);m.setPixelRatio(window.devicePixelRatio);s.appendChild(m.domElement);const g=new D(u,m.domElement);g.enableDamping=!0;g.dampingFactor=.05;g.minDistance=15;g.maxDistance=50;const P=10;let y=[],q="day";const N=new T(P,64,64);function K(){const t=document.createElement("canvas");t.width=1024,t.height=512;const e=t.getContext("2d");e.fillStyle="#1a3a5c",e.fillRect(0,0,t.width,t.height);for(let n=0;n<5e3;n++){const o=Math.random()*t.width,a=Math.random()*t.height;e.fillStyle=`rgba(20, 60, 100, ${Math.random()*.3})`,e.fillRect(o,a,2,2)}return e.fillStyle="#2d5a3d",e.beginPath(),e.moveTo(100,120),e.lineTo(250,100),e.lineTo(280,180),e.lineTo(260,280),e.lineTo(180,300),e.lineTo(80,250),e.lineTo(60,180),e.closePath(),e.fill(),e.beginPath(),e.moveTo(220,300),e.lineTo(280,320),e.lineTo(300,420),e.lineTo(260,480),e.lineTo(220,450),e.lineTo(200,350),e.closePath(),e.fill(),e.beginPath(),e.moveTo(480,100),e.lineTo(560,90),e.lineTo(580,140),e.lineTo(540,180),e.lineTo(480,170),e.closePath(),e.fill(),e.beginPath(),e.moveTo(480,200),e.lineTo(580,190),e.lineTo(600,280),e.lineTo(560,400),e.lineTo(500,380),e.lineTo(460,280),e.closePath(),e.fill(),e.beginPath(),e.moveTo(580,80),e.lineTo(850,100),e.lineTo(900,200),e.lineTo(800,280),e.lineTo(650,260),e.lineTo(600,180),e.closePath(),e.fill(),e.beginPath(),e.moveTo(820,350),e.lineTo(920,340),e.lineTo(940,420),e.lineTo(880,450),e.lineTo(820,420),e.closePath(),e.fill(),e.fillStyle="#4a6a7a",e.fillRect(0,470,t.width,42),new U(t)}const X=new G({map:K(),bumpScale:.05,specular:new H(3355443),shininess:5}),C=new v(N,X);l.add(C);const Y=new T(P*1.02,64,64),Z=new x({color:4491519,transparent:!0,opacity:.1,side:z}),ee=new v(Y,Z);l.add(ee);const te=new W(4210752,1);l.add(te);const b=new F(16777215,1.5);b.position.set(50,30,50);l.add(b);const S=new _,B=3e3,w=new Float32Array(B*3);for(let t=0;t<B;t++)w[t*3]=(Math.random()-.5)*500,w[t*3+1]=(Math.random()-.5)*500,w[t*3+2]=(Math.random()-.5)*500;S.setAttribute("position",new Q(w,3));const ne=new V(S,new O({color:16777215,size:.5}));l.add(ne);u.position.set(0,15,30);u.lookAt(0,0,0);function oe(t,e,n){const o=(90-t)*(Math.PI/180),a=(e+180)*(Math.PI/180);return new J(-n*Math.sin(o)*Math.cos(a),n*Math.cos(o),n*Math.sin(o)*Math.sin(a))}function ae(t){return t<2.5?4500036:t<4.5?14526976:t<6?16737860:16720418}function ie(t){return t<2.5?.08:t<4.5?.15:t<6?.25:.4+(t-6)*.1}function se(){y.forEach(t=>{l.remove(t),t.geometry.dispose(),t.material.dispose()}),y=[]}function re(t,e,n,o){const a=oe(t,e,P+.1),c=ie(n),d=ae(n),M=new T(c,16,16),r=new x({color:d,transparent:!0,opacity:.9}),i=new v(M,r);if(i.position.copy(a),n>=4.5){const f=new T(c*2,16,16),p=new x({color:d,transparent:!0,opacity:.3}),k=new v(f,p);i.add(k)}l.add(i),y.push(i)}async function E(){const t={hour:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson",day:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson",week:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson",month:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson"};try{const n=await(await fetch(t[q])).json();se();let o=0,a=0,c=0;const d=[];n.features.forEach(r=>{const i=r.geometry.coordinates,f=i[0],p=i[1],k=i[2],h=r.properties.mag||0,j=r.properties.place||"Unknown location",A=r.properties.time;h>0&&(re(p,f,h,k),o++,h>=4.5&&a++,h>c&&(c=h),(h>=4||d.length<5)&&d.push({mag:h,place:j,time:A,lat:p,lon:f}))}),d.sort((r,i)=>i.mag-r.mag);const M=d.slice(0,5);document.getElementById("totalCount").textContent=o.toLocaleString(),document.getElementById("majorCount").textContent=a,document.getElementById("largestMag").textContent=c>0?`M${c.toFixed(1)}`:"-",le(M)}catch(e){console.error("Error fetching earthquake data:",e),document.getElementById("totalCount").textContent="Error loading data"}}function le(t){const e=document.getElementById("quakeList");if(t.length===0){e.innerHTML=`
      <div class="quake-item">
        <div class="quake-mag minor">-</div>
        <div class="quake-info">
          <div class="quake-location">No significant earthquakes in this time range</div>
          <div class="quake-time">Try selecting a longer time period</div>
        </div>
      </div>
    `;return}e.innerHTML=t.map(n=>{const o=n.mag<2.5?"minor":n.mag<4.5?"moderate":n.mag<6?"major":"great",a=ce(n.time);return`
      <div class="quake-item">
        <div class="quake-mag ${o}">${n.mag.toFixed(1)}</div>
        <div class="quake-info">
          <div class="quake-location">${n.place}</div>
          <div class="quake-time">${a}</div>
        </div>
      </div>
    `}).join("")}function ce(t){const e=Math.floor((Date.now()-t)/1e3);return e<60?"Just now":e<3600?`${Math.floor(e/60)} minutes ago`:e<86400?`${Math.floor(e/3600)} hours ago`:`${Math.floor(e/86400)} days ago`}window.changeTimeRange=function(){q=document.getElementById("timeRange").value,E()};function L(){requestAnimationFrame(L),C.rotation.y+=5e-4;const t=Date.now()*.002;y.forEach((e,n)=>{const o=1+Math.sin(t+n*.5)*.1;e.scale.setScalar(o)}),g.update(),m.render(l,u)}E();setInterval(E,6e4);L();window.addEventListener("resize",()=>{u.aspect=s.clientWidth/s.clientHeight,u.updateProjectionMatrix(),m.setSize(s.clientWidth,s.clientHeight)});
